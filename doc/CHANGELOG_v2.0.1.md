# v2.0.1 更新日志

发布日期：2025-12-31

## ✨ 新增功能

### OCR 忽略非气泡文本功能扩展
- **所有 OCR 模型现已支持 `ignore_bubble` 参数**
  - 之前仅 `48px_ctc` 和 `32px` 支持，现在 `48px`、`manga_ocr`、`paddleocr` 也支持
  - 自动过滤非对话框区域的文本（如标题、音效、背景文字等）
  - 参数范围：0-1（0 表示禁用）
  - 阈值越低过滤越宽松，阈值越高过滤越严格
  - 工作原理：
    - 检测文本框边缘的黑白像素比例
    - 正常气泡（边缘纯白或纯黑）→ 保留翻译
    - 非气泡区域（边缘黑白混杂）→ 自动跳过
    - 彩色文字 → 自动跳过

### 替换翻译模式
- 新增 **替换翻译模式**：从已翻译图片提取翻译数据并应用到生肉图片
  - 自动匹配生肉图和翻译图的文本区域
  - 支持多对一匹配（多个生肉框对应一个翻译框）
  - 自动保存优化后的蒙版，Qt 编辑器加载时跳过蒙版优化
  - 支持导出可编辑 PSD 文件
  - **新增直接粘贴模式**：
    - 启用 `enable_template_alignment` 后，根据坐标匹配直接从翻译图裁剪区域并粘贴
    - 不经过 OCR，保留所有符号、音效、装饰性文字
    - 字体样式完全一致（直接复制图像）
  - 工作流程：
    1. 准备生肉图和对应的翻译图
    2. 将翻译图放在 `原图目录/manga_translator_work/translated_images/` 目录下
    3. 选择"替换翻译"模式
    4. 添加生肉图片
    5. 程序自动从翻译图提取 OCR 结果或直接裁剪区域
    6. 匹配区域并应用翻译
    7. 保存结果到 `manga_translator_work` 目录

### 编辑器快捷键增强
- 新增 **Ctrl + 鼠标滚轮**：等比例缩放选中文本框（包括框的大小和字体），每次缩放 5%
- 新增 **Shift + 鼠标滚轮**：调整蒙版画笔大小，每次 ±1 像素，范围 5-200
- 画笔大小滑块范围扩展至 5-200，支持更精细的调整

## 🐛 修复

### 翻译完成提示
- 修复翻译完成后不弹出提示框的 bug
- 确保用户能及时收到翻译任务完成的通知

### 导出图片稳定性
- 提高了导出图片的稳定性
- 优化了图片导出流程，减少导出失败的情况
- 改进了异常处理机制，提升导出可靠性

### PSD导出角度修复
- 修复了PSD导出时文本旋转角度反向的问题
- 现在导出的PSD文件中文本旋转方向与原图一致

### 模型下载优化
- 添加下载超时机制（默认30秒），避免长时间卡住
- 切换备用下载链接时自动清理残留文件，解决 HTTP 416 错误
- 提升模型下载的稳定性和成功率

## ⚡ 优化

- 改进了用户体验，确保关键操作的反馈及时准确
- 优化了模型下载流程，提高下载成功率
- 优化了编辑器的交互体验，支持更灵活的文本框和画笔调整
- 替换翻译模式自动跳过并行处理，确保稳定性
