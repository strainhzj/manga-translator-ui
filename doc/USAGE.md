# 使用教程

本文档提供程序的基础使用方法和常用设置。

---

## 📋 目录

- [首次使用](#首次使用)
- [基础操作](#基础操作)
- [翻译器选择](#翻译器选择)
- [常用设置](#常用设置)
- [可视化编辑](#可视化编辑)
- [常见问题](#常见问题)

---

## 首次使用

### 1. 下载模型文件（可选）

如果首次运行时自动下载模型失败或速度太慢，可以手动下载模型文件：

**模型文件网盘下载**：

- **夸克网盘**：
  - 链接：https://pan.quark.cn/s/e4e8d1635bf1
  - 提取码：`e77d39EiKf`

- **移动云盘**：
  - 链接：https://yun.139.com/shareweb/#/w/i/2qidZUhfLSS6i
  - 提取码：`ahbl`

- **联通云盘**：
  - 链接：https://pan.wo.cn/s/1r1h4V35426
  - 提取码：`FaQS`

- **百度网盘**：
  - 链接：https://pan.baidu.com/s/17YIs2nvgUAapcTI1i0ncFA?pwd=3w3u
  - 提取码：`3w3u`

**下载后的使用方法**：
1. 下载 `models` 文件夹
2. 将 `models` 文件夹放到程序根目录（与 `app.exe` 或 `步骤2-启动Qt界面.bat` 同级）
3. 启动程序即可使用

> 💡 **提示**：如果程序能正常自动下载模型，则无需手动下载

### 2. 启动程序

根据你的安装方式选择启动方法：

**脚本安装版本**：
- 双击 `步骤2-启动Qt界面.bat`

**打包版本**：
- 双击 `app.exe`

**手动部署版本**：
- 运行命令：`py -3.12 -m desktop_qt_ui.main`

首次运行会：
- 自动加载 AI 模型（需要 3-5 分钟）
- 初始化翻译引擎
- 打开主界面

### 3. CPU 版本必做设置

如果使用 **CPU 版本**或没有 NVIDIA 显卡：

1. 点击"**基础设置**"标签页
2. **取消勾选"使用 GPU"**
3. 点击"**保存配置**"

> ⚠️ **重要**：CPU 版本或没有 NVIDIA 显卡时启用 GPU 会导致程序崩溃！

### 4. 设置输出目录

1. 在主界面点击"**选择输出文件夹**"按钮
2. 选择翻译结果的保存位置
3. 程序会自动记住此设置

---

## 基础操作

### 添加图片

支持三种方式：

1. **点击添加文件**：
   - 点击"添加文件"按钮
   - 选择一个或多个图片文件

2. **添加整个文件夹**：
   - 点击"添加文件夹"按钮
   - 选择包含图片的文件夹
   - 程序会自动扫描所有图片

3. **拖拽添加**（最方便）：
   - 直接拖拽图片或文件夹到窗口
   - 支持同时拖拽多个文件/文件夹

**支持的图片格式**：`.jpg`、`.jpeg`、`.png`、`.webp`、`.bmp`

### 选择翻译器

1. 在"**基础设置**"标签页找到"**翻译器**"下拉菜单
2. 首次使用推荐选择：
   - **高质量翻译 OpenAI** 或 **高质量翻译 Gemini**（多模态，看图翻译，效果最好）⭐ 强烈推荐
   - **OpenAI** 或 **Gemini**（纯文本翻译，需配置 API）

> 💡 **重要提示**：
> - **高质量翻译器**需要模型支持多模态（如 GPT-4o、Gemini）才能使用看图翻译功能
> - DeepSeek 等模型不支持多模态，**无法使用高质量翻译器**，请选择普通翻译器
> - 在线翻译器需要配置 API Key → [查看 API 配置教程](API_CONFIG.md)

### 选择目标语言

1. 在"**基础设置**"中找到"**目标语言**"下拉菜单
2. 常用选择：
   - **简体中文**（CHS）
   - **繁体中文**（CHT）
   - **英语**（ENG）

### 开始翻译

1. 确认设置无误：
   - ✓ GPU 设置正确（CPU 版本需关闭）
   - ✓ 选择了输出文件夹
   - ✓ 添加了图片
   - ✓ 选择了翻译器和目标语言

2. 点击"**开始翻译**"按钮

3. 等待翻译完成：
   - 进度条显示翻译进度
   - 日志窗口显示详细信息
   - 可以随时点击"停止"按钮中断翻译

4. 查看结果：
   - 翻译完成后，结果自动保存到输出文件夹
   - 文件名格式：`原文件名_translated.jpg`

---

## 翻译器选择

### 离线翻译器（无需网络）

适合快速翻译，无需任何配置：

| 翻译器 | 特点 | 速度 | 质量 | 推荐场景 |
|--------|------|------|------|----------|
| **Sugoi** | 日→英专用 | ⚡⚡⚡ | ★★★ | 日语漫画快速翻译 |
| **NLLB** | 多语言通用 | ⚡⚡⚡ | ★★★ | 通用翻译 |
| **NLLB Big** | 大模型版本 | ⚡⚡ | ★★★★ | 追求质量 |
| **M2M100** | 多语言 | ⚡⚡ | ★★★ | 多语言场景 |
| **Qwen2** | 通义千问 | ⚡⚡ | ★★★ | 中文翻译 |

### 在线翻译器（需要 API Key）

需要配置 API Key，但翻译质量更好：

| 翻译器 | 特点 | 费用 | 质量 | 配置难度 |
|--------|------|------|------|----------|
| **DeepL** | 专业翻译 | 💰💰 | ★★★★★ | ⭐ 简单 |
| **百度翻译** | 中文友好 | 💰 | ★★★★ | ⭐ 简单 |
| **有道翻译** | 中文友好 | 💰 | ★★★★ | ⭐ 简单 |

### 高质量翻译器（强烈推荐）

使用多模态 AI 模型，结合图片上下文翻译：

| 翻译器 | 特点 | 优势 | 推荐度 |
|--------|------|------|--------|
| **高质量翻译 OpenAI** | GPT-4o | 📸 看图翻译，理解上下文 | ⭐⭐⭐⭐⭐ |
| **OpenAI** | GPT-4o | 纯文本翻译 | ⭐⭐⭐⭐ |
| **高质量翻译 Gemini** | Gemini | 📸 看图翻译，速度快 | ⭐⭐⭐⭐⭐ |
| **Gemini** | Gemini | 纯文本翻译 | ⭐⭐⭐⭐ |

**高质量翻译器的优势**：
- 📸 **多模态理解**：AI 可以"看到"图片，理解场景
- 🎯 **更准确**：结合图片信息，翻译更符合语境
- 📝 **批量处理**：一次发送多张图片，AI 理解整体剧情
- 🔧 **自定义提示词**：支持自定义翻译风格和术语表 → [如何添加提示词](SETTINGS.md#如何添加高质量提示词)

### 配置在线翻译器

需要配置 API Key 的翻译器，请查看详细配置教程：

**📚 API 配置教程** → [API_CONFIG.md](API_CONFIG.md)

在配置教程中，你可以学习如何：
- ✅ 注册和申请 API Key
- ✅ 在程序中配置 API
- ✅ 选择合适的模型

**推荐配置**：
- 🏆 **效果最佳**：OpenAI GPT-4o 或 Google Gemini（多模态模型）
- 🔥 **性价比高**：DeepSeek API（纯文本，国内用户推荐）

---

## 常用设置

### 翻译流程模式

程序提供 4 种工作流程，在"**翻译流程模式**"下拉菜单中选择：

1. **正常翻译流程**（默认）：
   - 直接翻译图片，生成翻译结果

2. **导出翻译**：
   - 翻译后导出翻译结果到 TXT 文件
   - 方便后续编辑修改

3. **导出原文**：
   - 仅检测和识别文字，导出原文到 TXT
   - 不进行翻译，用于手动翻译

4. **导入翻译并渲染**：
   - 从 TXT/JSON 文件导入翻译内容
   - 重新渲染图片（不进行翻译）

**详细工作流程说明** → [工作流程](WORKFLOWS.md)

### OCR 模型选择

在"**选项**"标签页中选择 OCR 模型：

- **48px**（推荐）：默认模型，平衡速度和准确率
- **48px_ctc**：CTC 模型，识别准确率更高
- **mocr**：Manga OCR 专用模型
- **paddleocr**：PaddleOCR 引擎，支持多语言

### 字体设置

程序会自动加载 `fonts` 目录下的所有字体。

**添加自定义字体**：详见 [设置说明 - 如何添加自定义字体](SETTINGS.md#如何添加自定义字体)

---

## 可视化编辑

翻译完成后，如果想修改翻译结果：

### 打开编辑器

1. 确保翻译时勾选了"**图片可编辑**"选项
2. 翻译完成后，在主界面点击"**打开编辑器**"
3. 选择要编辑的图片（必须有对应的 `_translations.json` 文件）

### 编辑操作

编辑器提供丰富的编辑功能：

- **区域编辑**：
  - 移动：拖拽文本框
  - 旋转：使用旋转手柄
  - 变形：拉伸文本框角点

- **文本编辑**：
  - 双击文本框修改译文
  - 右侧属性面板调整字体、大小、颜色
  - 切换横排/竖排

- **蒙版编辑**：
  - 使用画笔工具手动绘制擦除区域
  - 使用橡皮擦修正错误

- **撤销/重做**：
  - Ctrl+Z：撤销
  - Ctrl+Y：重做

**详细编辑功能** → [功能特性](FEATURES.md)

---

## 常见问题

### Q1：翻译速度很慢怎么办？

**可能原因和解决方法**：
1. **使用 CPU 翻译**：
   - CPU 版本比 GPU 版本慢 5-10 倍
   - 建议使用 GPU 版本（需要 NVIDIA 显卡）

2. **选择了大模型**：
   - NLLB Big、M2M100 Big 等大模型速度较慢
   - 建议改用 Sugoi、NLLB 等标准模型

3. **图片分辨率过高**：
   - 在"**高级设置**"中降低"**检测大小**"（默认 2048）
   - 降低"**修复大小**"

### Q2：翻译结果不准确怎么办？

**解决方法**：
1. **更换翻译器**：
   - 尝试使用高质量翻译器（OpenAI HQ、Gemini HQ）
   - 或尝试其他离线翻译器

2. **使用手动翻译**：
   - 选择"**导出原文**"流程
   - 手动翻译原文
   - 使用"**导入翻译并渲染**"重新渲染

3. **使用编辑器**：
   - 勾选"**图片可编辑**"
   - 翻译完成后打开编辑器
   - 手动修改译文

### Q3：检测不到所有文字怎么办？

**解决方法**：
1. **开启详细日志**：
   - 在"**基础设置**"中勾选"**详细日志**"
   - 查看 `result/` 目录中的调试文件

2. **调整检测参数**：
   - 在"**高级设置**"中降低"**文本阈值**"（默认 0.5）
   - 降低"**边界框生成阈值**"（默认 0.5）
   - 增大"**Unclip 比例**"（默认 2.5）

3. **使用编辑器手动添加**：
   - 在编辑器中点击"编辑形状"
   - 手动框选漏检的文字区域

**详细调试方法** → [调试指南](DEBUGGING.md)

### Q4：GPU 版本崩溃怎么办？

**解决方法**：
1. **检查显卡兼容性**：
   - 确认显卡支持 CUDA 12.x
   - 建议 GTX 1060 及以上

2. **更新驱动**：
   - 安装或更新 NVIDIA 显卡驱动
   - 安装 [CUDA Toolkit 12.x](https://developer.nvidia.com/cuda-downloads)

3. **改用 CPU 版本**：
   - 取消勾选"**使用 GPU**"
   - 或下载 CPU 版本的程序

### Q5：如何批量翻译整个文件夹？

**操作方法**：
1. 点击"**添加文件夹**"按钮
2. 选择包含图片的文件夹
3. 程序会自动扫描所有图片
4. 点击"**开始翻译**"
5. 等待所有图片翻译完成

> 💡 **提示**：可以在"**基础设置**"中设置"**批量大小**"来控制同时处理的图片数量

---

## 下一步

了解更多功能：
- [功能特性](FEATURES.md) - 查看所有功能
- [工作流程](WORKFLOWS.md) - 学习不同的工作流程
- [设置说明](SETTINGS.md) - 详细参数配置
- [调试指南](DEBUGGING.md) - 解决翻译问题

返回 [主页](../README.md)

